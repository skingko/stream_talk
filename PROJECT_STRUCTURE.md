# Stream-Talk é¡¹ç›®ç»“æ„

## ğŸ“ æ¸…ç†åçš„ç›®å½•ç»“æ„

```
stream-talk/
â”œâ”€â”€ ğŸš€ æ ¸å¿ƒæœåŠ¡
â”‚   â”œâ”€â”€ simple_voice_server.py          # ä¸»è¦åç«¯æœåŠ¡å™¨
â”‚   â”œâ”€â”€ spark_tts_wrapper.py            # Spark-TTSåŒ…è£…å™¨
â”‚   â”œâ”€â”€ start_backend.py                # åç«¯å¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ start_all.py                    # å¯åŠ¨æ‰€æœ‰æœåŠ¡
â”‚
â”œâ”€â”€ ğŸ¨ å‰ç«¯ç•Œé¢
â”‚   â””â”€â”€ frontend/                       # Vue3å‰ç«¯åº”ç”¨
â”‚       â”œâ”€â”€ src/                        # æºä»£ç 
â”‚       â”‚   â”œâ”€â”€ components/             # Vueç»„ä»¶
â”‚       â”‚   â””â”€â”€ composables/            # ç»„åˆå¼å‡½æ•°
â”‚       â”œâ”€â”€ package.json                # ä¾èµ–é…ç½®
â”‚       â””â”€â”€ start.sh                    # å‰ç«¯å¯åŠ¨è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ¤– AIæ¨¡å‹
â”‚   â””â”€â”€ models/                         # æ¨¡å‹æ–‡ä»¶
â”‚       â”œâ”€â”€ fish-speech/                # Fish Speech TTSæ¨¡å‹
â”‚       â”œâ”€â”€ spark-tts/                  # Spark-TTSæ¨¡å‹
â”‚       â”œâ”€â”€ stream-omni-8b/             # Stream-Omni 8Bæ¨¡å‹
â”‚       â””â”€â”€ whisper/                    # Whisperè¯­éŸ³è¯†åˆ«æ¨¡å‹
â”‚
â”œâ”€â”€ ğŸ”§ TENæ¡†æ¶ç»„ä»¶
â”‚   â”œâ”€â”€ third-party/                    # ç¬¬ä¸‰æ–¹é¡¹ç›®
â”‚   â”‚   â”œâ”€â”€ ten-framework/              # TENæ¡†æ¶æ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ ten-vad/                    # VADè¯­éŸ³æ´»åŠ¨æ£€æµ‹
â”‚   â”‚   â”œâ”€â”€ ten-turn-detection/         # Turn Detectionè½®æ¬¡æ£€æµ‹
â”‚   â”‚   â””â”€â”€ fish-speech/                # Fish Speeché¡¹ç›®
â”‚   â””â”€â”€ extensions/                     # TENæ‰©å±•ç»„ä»¶
â”‚       â”œâ”€â”€ conversation_manager/       # å¯¹è¯ç®¡ç†
â”‚       â”œâ”€â”€ fish_speech_tts/           # Fish Speech TTSæ‰©å±•
â”‚       â”œâ”€â”€ lm_studio_llm/             # LM Studio LLMæ‰©å±•
â”‚       â”œâ”€â”€ ten_turn_detection/        # Turn Detectionæ‰©å±•
â”‚       â””â”€â”€ ten_vad/                   # VADæ‰©å±•
â”‚
â”œâ”€â”€ ğŸµ éŸ³é¢‘èµ„æº
â”‚   â””â”€â”€ assets/                         # é™æ€èµ„æº
â”‚       â”œâ”€â”€ model.png                   # æ¨¡å‹æ¶æ„å›¾
â”‚       â”œâ”€â”€ stream-omni.png             # é¡¹ç›®logo
â”‚       â”œâ”€â”€ éŸ³é¢‘æ ·æœ¬1.-æ¸©å©‰å¥³å£°wav.wav    # å‚è€ƒéŸ³é¢‘æ ·æœ¬
â”‚       â””â”€â”€ éŸ³é¢‘æ ·æœ¬2-å¯çˆ±å¥³å£°.wav       # å¤‡ç”¨éŸ³é¢‘æ ·æœ¬
â”‚
â”œâ”€â”€ ğŸ“š æ–‡æ¡£
â”‚   â””â”€â”€ docs/                           # é¡¹ç›®æ–‡æ¡£
â”‚       â”œâ”€â”€ Voice_Conversation_System_Guide.md
â”‚       â”œâ”€â”€ TEN_INTEGRATION_GUIDE.md
â”‚       â”œâ”€â”€ Project_Final_Summary.md
â”‚       â”œâ”€â”€ SPARK_TTS_INTEGRATION.md
â”‚       â””â”€â”€ Stream-Omni_Implementation_Summary.md
â”‚
â”œâ”€â”€ âš™ï¸ é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ requirements.txt                # Pythonä¾èµ–
â”‚   â”œâ”€â”€ pyproject.toml                 # é¡¹ç›®é…ç½®
â”‚   â”œâ”€â”€ activate_env.sh                 # ç¯å¢ƒæ¿€æ´»è„šæœ¬
â”‚   â””â”€â”€ stream_omni/                   # æ ¸å¿ƒæ¨¡å—
â”‚
â””â”€â”€ ğŸ“„ é¡¹ç›®ä¿¡æ¯
    â”œâ”€â”€ README.md                      # é¡¹ç›®è¯´æ˜
    â”œâ”€â”€ LICENSE                        # è®¸å¯è¯
    â””â”€â”€ PROJECT_STRUCTURE.md           # é¡¹ç›®ç»“æ„è¯´æ˜
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. è¯­éŸ³äº¤äº’æœåŠ¡ (`simple_voice_server.py`)
- **WebSocketå®æ—¶é€šä¿¡**
- **faster-whisperè¯­éŸ³è¯†åˆ«** (large-v3-turbo, int8é‡åŒ–)
- **LM Studio + Qwen LLMå¯¹è¯**
- **Spark-TTSè¯­éŸ³åˆæˆ** (MLXä¼˜åŒ–)
- **VADè¯­éŸ³æ´»åŠ¨æ£€æµ‹**
- **Turn Detectionè½®æ¬¡åˆ¤æ–­**
- **æ™ºèƒ½å›éŸ³æŠ‘åˆ¶**

### 2. TTSå¼•æ“ (`spark_tts_wrapper.py`)
- **Spark-TTS MLXä¼˜åŒ–ç‰ˆæœ¬**
- **æµå¼éŸ³é¢‘ç”Ÿæˆ**
- **ç»†ç²’åº¦æ–­å¥åˆ†å‰²** (3ä¸ªæ–­å¥ä¸ºä¸€ç»„)
- **æŒä¹…åŒ–æ¨¡å‹å®ä¾‹**
- **MPS GPUåŠ é€Ÿæ”¯æŒ**

### 3. å‰ç«¯ç•Œé¢ (`frontend/`)
- **Vue3 + Element Plus**
- **å®æ—¶è¯­éŸ³äº¤äº’ç•Œé¢**
- **æ–‡æœ¬/è¯­éŸ³æ¨¡å¼åˆ‡æ¢**
- **æµå¼éŸ³é¢‘æ’­æ”¾**
- **å¯¹è¯å†å²ç®¡ç†**
- **è‡ªåŠ¨é‡è¿æœºåˆ¶**

### 4. AIæ¨¡å‹é›†æˆ
- **Qwen2.5ç³»åˆ—**: å¤§è¯­è¨€æ¨¡å‹ (é€šè¿‡LM Studio)
- **Spark-TTS**: é«˜è´¨é‡TTSè¯­éŸ³åˆæˆ (MLXä¼˜åŒ–)
- **faster-whisper large-v3-turbo**: è¯­éŸ³è¯†åˆ« (int8é‡åŒ–)
- **TEN VAD**: è¯­éŸ³æ´»åŠ¨æ£€æµ‹
- **TEN Turn Detection**: å¯¹è¯è½®æ¬¡æ£€æµ‹

### 5. ç¬¬ä¸‰æ–¹åº“ç®¡ç† (`third_party_paths.py`)
- **ç»Ÿä¸€è·¯å¾„é…ç½®**
- **è‡ªåŠ¨è·¯å¾„æ£€æµ‹**
- **å¯¼å…¥è·¯å¾„ç®¡ç†**
- **åº“å¯ç”¨æ€§éªŒè¯**

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### å¯åŠ¨åç«¯æœåŠ¡
```bash
python start_backend.py
```

### å¯åŠ¨å‰ç«¯ç•Œé¢
```bash
cd frontend
npm run dev
# æˆ–è€…
./start.sh
```

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

### ç¡¬ä»¶è¦æ±‚
- **macOS**: Apple Silicon (M1/M2/M3) æ¨èï¼Œæ”¯æŒMPSåŠ é€Ÿ
- **å†…å­˜**: 16GB+ æ¨è (æ¨¡å‹åŠ è½½éœ€è¦)
- **å­˜å‚¨**: 20GB+ å¯ç”¨ç©ºé—´ (æ¨¡å‹æ–‡ä»¶è¾ƒå¤§)

### è½¯ä»¶ç¯å¢ƒ
- **Python**: 3.11+
- **Node.js**: 16+ (å‰ç«¯å¼€å‘)
- **conda**: ç”¨äºç¯å¢ƒç®¡ç†

### æ¨¡å‹è¦æ±‚
- **LM Studio**: æœ¬åœ°LLMæ¨ç†æœåŠ¡
- **Qwen2.5**: 7Bæˆ–14Bç‰ˆæœ¬æ¨è
- **Spark-TTS**: MLXä¼˜åŒ–ç‰ˆæœ¬ï¼Œè‡ªåŠ¨ä¸‹è½½
- **faster-whisper**: large-v3-turboï¼Œè‡ªåŠ¨ä¸‹è½½

## ğŸ”— è®¿é—®åœ°å€

- **å‰ç«¯ç•Œé¢**: http://localhost:5173
- **åç«¯API**: http://localhost:8002
- **WebSocket**: ws://localhost:8002/ws/voice
- **LM Studio**: http://localhost:1234

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **macOSä¼˜åŒ–**: é¡¹ç›®ä¸“ä¸ºApple Siliconä¼˜åŒ–ï¼Œæ”¯æŒMPS GPUåŠ é€Ÿ
2. **æ¨¡å‹è‡ªåŠ¨ä¸‹è½½**: Spark-TTSå’Œfaster-whisperæ¨¡å‹é¦–æ¬¡ä½¿ç”¨æ—¶è‡ªåŠ¨ä¸‹è½½
3. **å‚è€ƒéŸ³é¢‘**: `assets/` ç›®å½•ä¸­çš„éŸ³é¢‘æ–‡ä»¶ç”¨äºTTSéŸ³è‰²å‚è€ƒ
4. **å›éŸ³æŠ‘åˆ¶**: ç³»ç»Ÿè‡ªåŠ¨å¤„ç†AIè¯­éŸ³å›éŸ³ï¼Œé¿å…è‡ªæ¿€å¯¹è¯
5. **å†…å­˜ç®¡ç†**: ä½¿ç”¨æŒä¹…åŒ–æ¨¡å‹å®ä¾‹ï¼Œå‡å°‘é‡å¤åŠ è½½

## ğŸ› ï¸ å¼€å‘è¯´æ˜

- **æ ¸å¿ƒæœåŠ¡å™¨**: `simple_voice_server.py` æ˜¯ä¸»è¦çš„åç«¯æœåŠ¡
- **TTSåŒ…è£…å™¨**: `spark_tts_wrapper.py` å¤„ç†Spark-TTSè¯­éŸ³åˆæˆ
- **è·¯å¾„ç®¡ç†**: `third_party_paths.py` ç»Ÿä¸€ç®¡ç†ç¬¬ä¸‰æ–¹åº“è·¯å¾„
- **å‰ç«¯ç»„ä»¶**: ä½äº `frontend/src/` ç›®å½•
- **æ‰©å±•å¼€å‘**: å¯åœ¨ `extensions/` ç›®å½•æ·»åŠ æ–°åŠŸèƒ½

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### ğŸš€ æ ¸å¿ƒä¼˜åŒ–
- **MPS GPUåŠ é€Ÿ**: å®Œæ•´æ”¯æŒApple Silicon GPUåŠ é€Ÿ
- **æµå¼å¤„ç†**: éŸ³é¢‘æ•°æ®é‡‡ç”¨æµå¼ä¼ è¾“ï¼Œè¾¹ç”Ÿæˆè¾¹æ’­æ”¾
- **æŒä¹…åŒ–å®ä¾‹**: TTSæ¨¡å‹ä½¿ç”¨æŒä¹…åŒ–å®ä¾‹ï¼Œé¿å…é‡å¤åŠ è½½
- **å¼‚æ­¥å¤„ç†**: æ‰€æœ‰IOæ“ä½œå‡ä¸ºå¼‚æ­¥ï¼Œæå‡å¹¶å‘æ€§èƒ½

### ğŸµ TTSä¼˜åŒ–
- **MLXæ¡†æ¶**: ä½¿ç”¨MLXä¼˜åŒ–çš„Spark-TTSï¼Œä¸“ä¸ºApple Siliconè®¾è®¡
- **ç»†ç²’åº¦åˆ†å‰²**: 3ä¸ªæ–­å¥ä¸ºä¸€ç»„ï¼Œä¼˜åŒ–è¯­éŸ³æµç•…åº¦
- **å®æ—¶ç‡**: <0.4sé¦–å¸§å»¶è¿Ÿï¼Œå®æ—¶ç‡0.44x-0.97x
- **å†…å­˜ä¼˜åŒ–**: æ™ºèƒ½ç¼“å­˜å’Œå†…å­˜ç®¡ç†

### ğŸ¯ ASRä¼˜åŒ–
- **int8é‡åŒ–**: faster-whisperä½¿ç”¨int8é‡åŒ–ï¼Œæå‡æ¨ç†é€Ÿåº¦
- **beamæœç´¢**: beam_size=5ï¼Œå¹³è¡¡é€Ÿåº¦å’Œè´¨é‡
- **ä¸­æ–‡ä¼˜åŒ–**: ä¸“é—¨ä¼˜åŒ–ä¸­æ–‡è¯­éŸ³è¯†åˆ«å‡†ç¡®ç‡

### ğŸ”‡ æ™ºèƒ½ä¼˜åŒ–
- **å›éŸ³æŠ‘åˆ¶**: æ—¶é—´çª—å£+è¯´è¯äººè¯†åˆ«ï¼Œé˜²æ­¢AIè¯­éŸ³å¹²æ‰°
- **è‡ªåŠ¨é‡è¿**: WebSocketè‡ªåŠ¨é‡è¿ï¼Œä¿è¯è¿æ¥ç¨³å®šæ€§
- **çŠ¶æ€ç®¡ç†**: æ™ºèƒ½å¯¹è¯çŠ¶æ€ç®¡ç†ï¼Œæ”¯æŒæ— é™è½®æ¬¡å¯¹è¯
